<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
<meta name="theme-color" content="#ff6fa3"/>
<title>100ì¼ ëª¨í—˜: ì„œí¬ë¥¼ í–¥í•œ ì—¬ì •</title>
<style>
:root{ --bg:#ffffff; --text:#342133; --pink:#ff6fa3; --pink2:#ffd6e7; --pink3:#fff3f8; --accent:#ff8db6; --accent2:#ff6fa3; --card:#ffffff; --border:#ffd6e7; --muted:#775a73; }*{box-sizing:border-box} html,body{margin:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif, system-ui, -apple-system, "Noto Sans KR", "Apple SD Gothic Neo", Roboto, Arial, sans-serif} .container{max-width:900px;margin:0 auto;padding:16px} .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 10px 30px rgba(255,111,163,.07);padding:16px} .h1{font-size:clamp(20px, 5vw, 26px);margin:0 0 8px} .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center} .btn{border:0;border-radius:12px;padding:12px 16px;font-weight:800;cursor:pointer;background:linear-gradient(135deg,var(--pink),var(--accent));color:#fff;box-shadow:0 8px 24px rgba(255,111,163,.35);min-height:44px;touch-action:manipulation} .btn:active{transform:translateY(1px)} .soft{border:1px solid var(--border);background:var(--pink3);padding:10px 12px;border-radius:10px;min-height:44px;touch-action:manipulation} .tag{display:inline-flex;align-items:center;gap:8px;background:var(--pink3);border:1px dashed var(--border);border-radius:999px;padding:8px 10px} .muted{color:var(--muted)} .section{margin-top:14px} .progress{height:10px;background:var(--pink3);border:1px solid var(--border);border-radius:999px;overflow:hidden} .progress>span{display:block;height:100%;background:linear-gradient(90deg,var(--pink),var(--pink2))} .hidden{display:none} /* stages */ .stage{display:none} .stage.active{display:block;animation:fade .3s ease} @keyframes fade{from{opacity:.0;transform:translateY(6px)}to{opacity:1;transform:none}} /* CH1 í€´ì¦ˆ */ .quiz-head{display:flex;justify-content:space-between;align-items:end;gap:12px;flex-wrap:wrap} .q-list{display:grid;grid-template-columns:1fr;gap:12px;margin-top:10px} .q-item{padding:12px;border:1px solid var(--border);border-radius:12px;background:var(--pink3)} .q-item b{color:var(--pink)} .opt{display:flex;gap:8px;align-items:center;margin-top:8px;padding:8px;border-radius:10px;border:1px solid var(--border);background:#fff;min-height:44px;touch-action:manipulation} .opt input{accent-color:var(--pink);min-width:20px;min-height:20px} .quiz-actions{display:flex;gap:10px;align-items:center;margin-top:10px;flex-wrap:wrap} .badge-pass{display:none;padding:8px 10px;border-radius:999px;background:linear-gradient(90deg,var(--pink),var(--pink2));color:#3e1730;font-weight:900} .badge-pass.on{display:inline-block} /* CH2 ìˆ¨ì€ í•˜íŠ¸ */ #findwrap{position:relative; width:min(94vw, 620px); aspect-ratio:1/0.65; border-radius:14px; overflow:hidden; border:1px solid var(--border); background:#f9f0f4; margin:0 auto} #findwrap img{width:100%;height:100%;object-fit:cover;display:block} .heart{position:absolute;width:min(30px, 6vw);height:min(30px, 6vw);border-radius:50%;background:var(--pink);box-shadow:0 6px 16px rgba(255,111,163,.35);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:900;cursor:pointer;user-select:none;touch-action:manipulation} /* CH3 ë¯¸ë¡œ */ #maze{touch-action:none; width:min(94vw, 360px); height:min(94vw,360px); background:var(--pink3); border:1px solid var(--border); border-radius:14px; position:relative; overflow:hidden; margin:0 auto} .cell{position:absolute;border:1px solid #f0c5d6; background:#fff} .player,.goal{position:absolute;border-radius:8px} .player{background:var(--pink); box-shadow:0 4px 12px rgba(255,111,163,.35)} .goal{background:#a8e7ff} /* CH4 í¼ì¦ */ #board{position:relative;width:min(94vw,360px);height:min(94vw,360px);margin:auto;border-radius:14px;overflow:hidden;border:1px solid var(--border);background:#fff} .piece{position:absolute;cursor:grab;user-select:none;border:1px solid #f0c5d6;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.08);touch-action:manipulation} .preview{width:min(150px, 30vw);border:1px solid var(--border);border-radius:12px;overflow:hidden;background:#fff} /* ì„ ë¬¼ ì„¹ì…˜ */ .gift-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px} .gift-card{border:1px solid var(--border);background:var(--card);border-radius:14px;overflow:hidden} .gift-thumb{background:var(--pink3);border-bottom:1px solid var(--border);padding:10px} .gift-thumb img{width:100%;display:block;border-radius:10px} .gift-info{padding:12px} .gift-title{font-weight:900;color:var(--pink)} .fallback{width:100%;aspect-ratio:4/2.4;border:1px dashed var(--border);border-radius:10px;display:flex;align-items:center;justify-content:center;background:#fff} /* Confetti Canvas */ #confetti{position:fixed;inset:0;pointer-events:none} /* ëª¨ë°”ì¼ ìµœì í™” */ @media (max-width: 768px) { .container{padding:12px} .card{padding:12px} .h1{font-size:22px} .btn,.soft{padding:10px 14px;font-size:14px} .quiz-head{flex-direction:column;align-items:flex-start;gap:8px} .quiz-actions{flex-direction:column;align-items:stretch} .quiz-actions .btn{width:100%} .row{flex-direction:column;align-items:stretch} .row .btn,.row .soft{width:100%} .preview{width:100%;max-width:200px} } </style>
</head>
<body>
<canvas id="confetti"></canvas>
<div class="container">
  <div class="card">
    <div class="row"><span class="tag">ğŸ’— 100ì¼ ëª¨í—˜ Â· for ì„œí¬</span></div>
    <h1 class="h1">ê²Œì„ì„ í´ë¦¬ì–´í•˜ë©´â€¦ <span style="color:var(--pink)">ì—”ë”©(í¸ì§€+BGM)</span>ì´ ì—´ë¦½ë‹ˆë‹¤!</h1>
    <div class="progress"><span id="pg" style="width:0%"></span></div>
  </div>

  <!-- CH1 í€´ì¦ˆ -->
  <div id="ch1" class="card stage active">
    <div class="quiz-head">
      <div>
        <h2>CH1 Â· ê¸°ì–µ í€´ì¦ˆ</h2>
        <p class="muted">ì •ë‹µì„ ëª¨ë‘ ë§íˆë©´ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°€ìš”. 9ê°œ ì´ìƒì´ë©´ ì¶•í•˜ ì»¨í˜í‹°! ğŸ‰</p>
      </div>
      <span id="quizPassed" class="badge-pass">âœ… í€´ì¦ˆ í†µê³¼!</span>
    </div>
    <div class="row" style="justify-content:space-between;align-items:center;margin-top:6px">
      <div class="tiny muted">ë³´ê¸° ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•˜ì„¸ìš”.</div>
      <div class="tiny muted" id="quizProg">0 / 12 ì‘ë‹µ</div>
    </div>
    <div id="quizList" class="q-list" aria-label="ìš°ë¦¬ë§Œì˜ ê¸°ì–µ í€´ì¦ˆ ë¬¸í•­ ëª©ë¡"></div>
    <div class="quiz-actions">
      <button class="btn" id="submitQuiz">ì±„ì í•˜ê¸°</button>
      <div id="quizResult" class="tiny muted"></div>
    </div>
  </div>

  <!-- CH2 ìˆ¨ì€ í•˜íŠ¸ -->
  <div id="ch2" class="card stage">
    <h2>CH2 Â· ìˆ¨ì€ í•˜íŠ¸ ì°¾ê¸°</h2>
    <p class="muted">ì‚¬ì§„ ì† í•˜íŠ¸ë¥¼ ëª¨ë‘ ì°¾ì•„ íƒ­í•˜ì„¸ìš”.</p>
    <div class="row section">
      <input id="bgUrl" class="soft" placeholder="assets/photo2.jpg (ê¸°ë³¸)"/>
      <button class="btn" id="applyBg">ë°°ê²½ ì ìš©</button>
    </div>
    <div id="findwrap" class="section">
  <img id="bg" src="assets/photo2.jpg" alt="ë°°ê²½"/>
  <!-- í•˜íŠ¸ë“¤ì€ JSë¡œ ì‚½ì… -->
</div>
    <div class="section muted"><span id="heartStatus">0 / 5</span></div>
  </div>

  <!-- CH3 ë¯¸ë¡œ -->
  <div id="ch3" class="card stage">
    <h2>CH3 Â· ê¸¸ì„ ì°¾ì•„ì„œ</h2>
    <p class="muted">í•˜íŠ¸ë¥¼ ë“œë˜ê·¸/ìŠ¤ì™€ì´í”„í•´ì„œ ê³¨(í•˜ëŠ˜ìƒ‰)ê¹Œì§€ ì´ë™í•˜ì„¸ìš”.</p>
    <div id="maze" class="section" aria-label="ë¯¸ë¡œ"></div>
  </div>

  <!-- CH4 í¼ì¦ -->
  <div id="ch4" class="card stage">
    <h2>CH4 Â· ëŸ¬ë¸Œ í¼ì¦</h2>
    <p class="muted">3Ã—3 ì‚¬ì§„ í¼ì¦ì„ ë§ì¶”ë©´ ì—”ë”©ì´ ì—´ë¦½ë‹ˆë‹¤.</p>
    <div class="row section" style="align-items:flex-end;justify-content:space-between">
      <div class="preview"><img id="pv" src="assets/photo.jpg" style="width:100%;display:block"/></div>
      <div class="row">
        <button class="soft" id="shuffle">ì„ê¸°</button>
        <button class="soft" id="snap">ìë™ì •ë ¬</button>
      </div>
    </div>
    <div id="board" class="section"></div>
    <div class="section muted" id="pstat">0% ì™„ë£Œ</div>
  </div>

  <!-- ì—”ë”© -->
  <div id="end" class="card stage">
    <h2>ì—”ë”© Â· ë¹„ë°€ í¸ì§€</h2>
    <div class="section">
      <div id="letter" class="soft" contenteditable="true" style="min-height:220px;line-height:1.7;white-space:pre-wrap">
ì‚¬ë‘í•˜ëŠ” ì„œí¬ì—ê²Œ,

ìš°ë¦¬ 100ì¼ì´ì•¼. ë­”ê°€ ê±°ì°½í•œ ë§ì„ ì“°ê¸°ë³´ë‹¤, ì§€ë‚œ ì‹œê°„ ë™ì•ˆ ë„¤ê°€ ë‚´ í•˜ë£¨ë¥¼ ì–´ë–»ê²Œ ë°”ê¿”ë†“ì•˜ëŠ”ì§€ ì†”ì§í•˜ê²Œ ì ì–´ë³¼ê²Œ.

ì²˜ìŒ ì—°ë‚¨ë™ì—ì„œ ì‹œê°„ ë§ì¶”ëŠë¼ ì„œë¡œ í—ˆë‘¥ëŒ€ë˜ ë‚ ì„ ì•„ì§ë„ ê¸°ì–µí•´. ì›¨ì´íŒ… ë²ˆí˜¸ í™•ì¸í•˜ê³ , ì–´ë””ê°€ ì¢‹ì„ì§€ ì´ê²ƒì €ê²ƒ ì•Œì•„ë³´ë˜ ê·¸ ë¶„ì£¼í•¨ê¹Œì§€. ê·¸ë•Œ ë‚œ ê¸´ì¥í–ˆê³ , ë„¤ê°€ â€œê´œì°®ì•„ìš”~â€ë¼ê³  ë§í•´ ì¤¬ë˜ ê·¸ ì—¬ìœ ê°€ ë§ˆìŒì„ ë§ì´ í¸í•˜ê²Œ í•´ì¤¬ì–´. ì²˜ìŒë¶€í„° ìš°ë¦¬ í†¤ì€ ë§‰ ë¶ˆê½ƒíŠ€ëŠ” ê²Œ ì•„ë‹ˆë¼, í¸ì•ˆí•¨ê³¼ ë°°ë ¤ì˜€ë˜ ê²ƒ ê°™ì•„.

ë„¤ê°€ ë² íŠ¸ë‚¨ì— ìˆë˜ ë©°ì¹ , ì‚¬ì§„ ë³´ë‚´ ì£¼ê³  ë‚ ì”¨ ì•Œë ¤ì£¼ê³ , ë°¤ë°”ë‹¤ ì•ì— ì•‰ì•„ ìˆë‹¤ë©° ì „í™”ë¥¼ ê±¸ë˜ ìˆœê°„ë“¤ì´ ì°¸ ì„ ëª…í•´. íŒ”ì— ë©ì´ í¬ê²Œ ë“¤ì—ˆë‹¤ê³  ì‚¬ì§„ì„ ë³´ë‚´ë˜ ë„ˆí•œí…Œ â€œê´œì°®ì•„?â€ ë¬»ë˜ ë‚´ ë§íˆ¬ì— ë‚˜ë„ ëª¨ë¥´ê²Œ ê±±ì •ì´ ë¬»ì–´ ìˆì—ˆì§€. í™”ë©´ ë„ˆë¨¸ë¡œ ì›ƒëŠ” ëª©ì†Œë¦¬ë¥¼ ë“£ì ë§ˆìŒì´ ë†“ì˜€ì–´. ë©€ë¦¬ ìˆì–´ë„, ìš°ë¦¬ëŠ” ì„œë¡œì˜ í•˜ë£¨ì— ê¼­ ë“¤ì–´ê°€ ìˆì—ˆêµ¬ë‚˜ ì‹¶ì—ˆì–´.

ìš°ë¦° ì‚¬ì†Œí•œ ê±¸ ìì£¼ ë‚˜ëˆ . ì ì‹¬ì‹œê°„ì— í—¬ìŠ¤ì¥ ë‹¤ë…€ì™”ë‹¤, ì˜¤ëŠ˜ì€ ëŸ¬ë‹ í˜ì´ìŠ¤ê°€ ì–´ë• ë‹¤, ì €ë…ì—” ë­˜ ë¨¹ì—ˆë‹¤ ê°™ì€ ì´ì•¼ê¸°ë“¤. ê±°ì°½í•˜ì§€ ì•Šì€ ì´ ê¸°ë¡ë“¤ì´ ìŒ“ì—¬ì„œ, ë‚˜ëŠ” ë„¤ í•˜ë£¨ì˜ ì˜¨ë„ë¥¼ ëŒ€ì¶©ì´ë¼ë„ ì§ì‘í•˜ê³ , ë„ˆë„ ë‚´ í•˜ë£¨ì˜ ì§ˆê°ì„ ì•Œì•„ê°€. ì´ê²Œ ì°¸ ë“ ë“ í•´.

ìŒì•… ì–˜ê¸°ë„ ì¢‹ì•˜ì§€. ì°¨ì—ì„œ ë“£ëŠ” ë…¸ë˜ ì·¨í–¥, ê·¸ë‚  ê°ì • ë”°ë¼ ê³ ë¥´ëŠ” OST, â€œìŠ¤íƒ€ ì´ì¦ˆ ë³¸â€ ì¢‹ì•„í•œë‹¤ê³  í–ˆì„ ë•Œ ê´œíˆ ë°˜ê°€ì› ì–´. ë‹¤ìŒì—” ë‚´ê°€ ì¢‹ì•„í•˜ëŠ” ì¬ì¦ˆë¥¼ ì‚´ì§ í‹€ê³ , ììœ ë¡œë¥¼ ì²œì²œíˆ ë‹¬ë¦¬ì. ì°½ë¬¸ ì¡°ê¸ˆ ì—´ê³ , ë§ì´ ì—†ì–´ë„ ì¢‹ì€ ê·¸ ê³µê¸°ë¥¼ ê°™ì´ ë“¤ì´ë§ˆì‹œì.

ê·¸ë¦¬ê³  ë‚´ê°€ í•œ ë§ë“¤ ê¼­ ì§€í‚¬ê²Œ.
ëŠ¦ì–´ì§€ë©´ ëŠ¦ëŠ”ë‹¤ê³  ë¨¼ì € ë§í• ê²Œ. ì¼ì •ì´ ë°”ë€Œë©´ ë°”ë¡œ ê³µìœ í• ê²Œ. â€œë§ ì•ˆ í•´ë„ ì•Œê² ì§€â€ë¼ëŠ” ìƒê° ëŒ€ì‹ , â€œë§í•´ì„œ ì•ˆì‹¬ì‹œì¼œ ì£¼ìâ€ë¥¼ ì„ íƒí• ê²Œ. í˜¹ì‹œ ì˜ê²¬ì´ ë‹¬ë¼ì„œ ë¶€ë”ªíˆë©´, ì´ê¸°ë ¤ ë“¤ê¸°ë³´ë‹¤ ë„¤ê°€ ë¬´ì–¼ ëŠê¼ˆëŠ”ì§€ë¶€í„° ì°¨ë¶„íˆ ë“¤ì„ê²Œ. ìˆ¨ í•œ ë²ˆ ê³ ë¥´ê³ , ë‚´ ì˜ë„ë¥¼ ë¨¼ì € ì„¤ëª…í•˜ê³ , ë„ˆì˜ ë§ˆìŒì„ í™•ì¸í•˜ì. ìš°ë¦¬í•œí… ê·¸ê²Œ ë” ì–´ìš¸ë¦°ë‹¤ê³  ë¯¿ì–´.

í•˜ê³  ì‹¶ì€ ê²ƒë„ ë§ì•„.
ìë™ì°¨ê·¹ì¥ë„ ë˜ ê°€ì. ë¹„ê°€ ì™€ë„ ê´œì°®ì•„. ì°¨ ì•ˆì—ì„œ ë‹´ìš” ë®ê³ , íŒì½˜ì€ ì‚´ì§ ì„¤ë ˆê²Œ ê³¼í•˜ê²Œ ì‹œí‚¤ê³ , ì˜í™” ëë‚˜ë©´ ì•„ë¬´ ë§ ì—†ì´ ìŒì•… í•œ ê³¡ë§Œ ë“£ì. ë­ ê¼­ ì‚¬ì§€ ì•Šì•„ë„, ì‹ ê¸°í•œ ê±° ë³´ë©´ì„œ â€œì´ëŸ° ê±´ ì–´ë•Œ?â€ í•˜ê³  ì›ƒì. ë„ˆê°€ â€œìš”ë¦¬ ì˜í•´ìš”?â€ë¼ê³  ë¬¼ì—ˆì„ ë•Œ ë†ë‹´ì²˜ëŸ¼ ë„˜ê²¼ì§€ë§Œ, ë¶€ì—Œë§Œ ìˆìœ¼ë©´ ë­ë“  ë§Œë“¤ì–´ ì¤„ ìì‹  ìˆì–´. ë‹¤ìŒì—ëŠ” ì§„ì§œ ë‚´ê°€ ì €ë… ì¤€ë¹„í• ê²Œ. ë„¤ê°€ ì¢‹ì•„í• ë§Œí•œ ë©”ë‰´ë¡œ, ê¸°ì™•ì´ë©´ ì‚¬ì§„ë„ ì˜ˆì˜ê²Œ ë‚˜ì˜¤ê²Œ.

ëˆˆì— ë„ëŠ” ì´ë²¤íŠ¸ê°€ ì—†ì–´ë„ ì¢‹ì•„. ë™ë„¤ ì‚°ì±…, ì¹´í˜ì—ì„œ ë‚˜ë€íˆ ì•‰ì•„ ê°ì í•  ì¼ í•˜ë‹¤ê°€ ì¤‘ê°„ì¤‘ê°„ ê³ ê°œ ë“¤ê³  ëˆˆ ë§ˆì£¼ì¹˜ëŠ” ìˆœê°„, ê·¸ëŸ° ê²Œ ë‚´ê² ì œì¼ í° ì´ë²¤íŠ¸ë”ë¼.

ê³ ë§ˆì› ë˜ ìˆœê°„ë“¤ì„ ì ë‹¤ ë³´ë‹ˆ ëì´ ì—†ë„¤. ë‚˜ë¥¼ ë¯¿ê³  ë”°ë¼ì™€ ì¤€ ê±°, ë°”ìœ ì™€ì¤‘ì—ë„ ë‚´ ì•ˆë¶€ ë¨¼ì € ì±™ê²¨ ì¤€ ê±°, ê°€ë”ì€ ê·€ì—½ê²Œ íˆ¬ì •ë„ ë¶€ë ¤ ì¤€ ê±°, í•˜ë‚˜ë„ í—ˆíˆ¬ë£¨ ë“£ì§€ ì•Šì•˜ì–´. ê·¸ë˜ì„œ ë‚˜ë„ ë” ì˜í•˜ê³  ì‹¶ì–´. â€œê´œì°®ì•„â€ì™€ â€œê³ ë§ˆì›Œâ€ë¥¼ ì•„ë¼ì§€ ì•Šê³ , â€œì‚¬ë‘í•´â€ë¼ëŠ” ë‹¨ì–´ì— ì£¼ì €í•˜ì§€ ì•ŠëŠ” ì‚¬ëŒìœ¼ë¡œ, ë„¤ ì˜†ì— ìˆê³  ì‹¶ì–´.

ë‹¤ìŒ 100ì¼ì—ë„ ìš°ë¦¬, ë˜‘ê°™ì´ë§Œ ê°€ì§€ ë§ê³  ì¡°ê¸ˆì”© ë” ë‚˜ì•„ê°€ ë³´ì.
í•˜ë£¨ì— í•œ ë²ˆì€ ë¨¼ì € ì—°ë½í•˜ê¸°, ëŠ¦ë”ë¼ë„ ì†”ì§íˆ ë§í•˜ê¸°, ì£¼ë§ì—” í•œ ë²ˆì€ í–‡ë³• ì•„ë˜ì—ì„œ ì‚°ì±…í•˜ê¸°, ì‚¬ì§„ í•œ ì¥ì€ ê¼­ ë‚¨ê¸°ê¸°, ê·¸ë¦¬ê³  ì„œë¡œì—ê²Œ â€œì˜¤ëŠ˜ ë„ˆ ë•ë¶„ì— ì¢‹ì•˜ì–´â€ í•œ ë§ˆë”” ê±´ë„¤ê¸°. ì´ëŸ° ì‘ì§€ë§Œ í™•ì‹¤í•œ ê²ƒë“¤ì„ ì§€ì¼œê°€ë©´, 1ë…„ì¯¤ ë’¤ì— ì§€ê¸ˆì˜ ìš°ë¦¬ë¥¼ ëŒì•„ë³´ë©° â€œìš°ë¦¬ê°€ ì°¸ ë§ì´ ë‹®ì•„ì¡Œêµ¬ë‚˜â€ í•˜ê³  ì›ƒì„ ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„.

ê²°ë¡ ì€ ëŠ˜ ê°™ì•„.
ë„ˆë¼ì„œ ë“ ë“ í•˜ê³ , ë„ˆë¼ì„œ í–‰ë³µí•´.
ìš°ë¦¬ ì²œì²œíˆ, ì˜¤ë˜ ê°€ì.

ëŠ˜ ì‚¬ë‘í•´.
í˜„í˜¸ ë“œë¦¼
      </div>
    </div>
    <div class="row section">
      <input id="bgmUrl" class="soft" placeholder="assets/bgm.mp3 (ê¸°ë³¸)"/>
      <button class="btn" id="applyBgm">BGM ì ìš©</button>
    </div>
    <audio id="bgm" controls src="assets/bgm.mpm3"></audio>
    <div class="section">
      <button class="btn" id="saveAll">í¸ì§€/ì„¤ì • ì €ì¥</button>
      <button class="btn" id="nextGift" style="margin-left:10px">ğŸ ì„ ë¬¼ ë³´ê¸°</button>
    </div>
  </div><!-- /end -->

  <!-- ì„ ë¬¼ í˜ì´ì§€ -->
  <div id="gift" class="card stage">
    <h2>ğŸ 100ì¼ ì„ ë¬¼</h2>
    <p class="muted">ìº¡ìŠì„ ì—´ì–´ë³´ì„¸ìš”! ê¹œì§ ì„ ë¬¼ì´ ë‚˜ì˜¬ ê±°ì˜ˆìš” âœ¨</p>
    <div class="gift-grid section">
      <!-- ì„ ë¬¼ #1: ë‰´ë°œë€ìŠ¤ í”„ë ˆì‰¬í¼ X More v5 -->
      <div class="gift-card">
        <div class="gift-thumb">
          <img src="assets/nb_more_v5.jpg" alt="ë‰´ë°œë€ìŠ¤ í”„ë ˆì‰¬í¼ X More v5" onerror="this.replaceWith(document.getElementById('nb-fallback').content.cloneNode(true))">
          <template id="nb-fallback">
            <div class="fallback">
              <svg viewBox="0 0 200 120" preserveAspectRatio="xMidYMid meet">
                <rect x="0" y="0" width="200" height="120" rx="12" fill="#fff"/>
                <path d="M20,80 C40,50 80,40 110,60 L145,65 L170,70 L180,85 L175,95 L40,95 Z" fill="#ffd6e7" stroke="#ff6fa3" stroke-width="3"/>
                <circle cx="62" cy="85" r="12" fill="#fff" stroke="#ff6fa3" stroke-width="3"/>
                <circle cx="134" cy="85" r="12" fill="#fff" stroke="#ff6fa3" stroke-width="3"/>
                <text x="100" y="28" text-anchor="middle" font-size="14" fill="#ff6fa3">Fresh Foam X More v5</text>
              </svg>
            </div>
          </template>
        </div>
        <div class="gift-info">
          <div class="gift-title">ë‰´ë°œë€ìŠ¤ ëŸ°ë‹í™” Â· í”„ë ˆì‰¬í¼ X More v5</div>
          <div class="muted tiny">ì‚¬ì´ì¦ˆ í™•ì¸í•´ì„œ ì˜ˆìœ ëŸ¬ë‹ ì‹œì‘í•˜ì! ğŸƒâ€â™€ï¸</div>
        </div>
      </div>
      <!-- ì„ ë¬¼ #2: ìº¡ìŠ ë½‘ê¸° GIF -->
      <div class="gift-card">
        <div class="gift-thumb" style="display:flex;justify-content:center;align-items:center">
          <img id="capsuleGif" src="assets/capsule_gacha.gif" alt="ìº¡ìŠ ë½‘ê¸° GIF" style="max-width:100%;height:auto"/>
        </div>
        <div class="gift-info">
          <div class="gift-title">í˜¸í…” ë§ˆì‚¬ì§€ê¶Œ 1ê°œ</div>
          <div class="muted tiny">ìº¡ìŠì„ ë½‘ì•˜ë”ë‹ˆâ€¦ ì˜¤ëŠ˜ì˜ ì„ ë¬¼! âœ¨</div>
          <div class="row" style="margin-top:8px">
            <button class="soft" onclick="const g=document.getElementById('capsuleGif'); g.src='assets/capsule_gacha.gif?'+Date.now()">ë‹¤ì‹œ ë½‘ê¸° ë³´ê¸°</button>
          </div>
        </div>
      </div>
    </div>
    <div class="section">
      <button class="btn" onclick="go(4)">â† í¸ì§€ë¡œ ëŒì•„ê°€ê¸°</button>
    </div>
  </div>
  </div><!-- /end -->
</div><!-- /container -->

<script>
/* ================= ê³µí†µ ì§„í–‰ë„ ================= */
const stages = ["ch1","ch2","ch3","ch4","end","gift"];
const pg = document.getElementById('pg');
let cur=0;
function go(i){
  cur=i;
  stages.forEach((id,k)=>document.getElementById(id).classList.toggle('active',k===i));
  pg.style.width=((i)/ (stages.length-1))*100+"%";
}
go(0);

/* ================= CH1: ê¸°ì–µ í€´ì¦ˆ ================= */
const quizData = [
  { q: "ì²˜ìŒ ë§Œë‚˜ê¸°ë¡œ í–ˆë˜ ë™ë„¤ëŠ”?", opts:["ì—°ë‚¨ë™","ë§ì›ë™","ì‹ ì´Œ"], a:0 },
  { q: "ì„œí¬ê°€ ì—¬í–‰ì§€ì—ì„œ ìì£¼ ë¨¹ì—ˆë‹¤ê³  í•œ ê³¼ì¼ì€?", opts:["íŒŒíŒŒì•¼","ë§ê³ ","ë‘ë¦¬ì•ˆ"], a:1 },
  { q: "í˜„í˜¸ê°€ ì ì‹¬ì‹œê°„ì— ê°€ë” í•˜ëŠ” ì¼ì€?", opts:["ë‚®ì  ìê¸°","ìš´ë™í•˜ê¸°","ë“œë¼ë§ˆ ë³´ê¸°"], a:1 },
  { q: "í•¨ê»˜ ë“£ìê³  ì–˜ê¸°í–ˆë˜ ê°€ìˆ˜ëŠ”?", opts:["ì¹˜ì¦ˆ(CHEEZE)","ì„ ìš°ì •ì•„","ìœ¤í•˜"], a:1 },
  { q: "'gmg'ëŠ” ë¬´ìŠ¨ ëœ»ì¼ê¹Œ?", opts:["ê°€ë©´ê°€","ê³ ë§™ê³ ","ê·¸ë§Œê°€ì"], a:0 },
  { q: "2025.05.15~16 ìš°ë¦¬ê°€ ë¬µì€ í˜¸í…”ì€?", opts:["ë¡¯ë°í˜¸í…” ì„œìš¸","í˜¸í…” ì˜¤ë…¸ë§ˆ(ëŒ€ì „)","íŒŒí¬í•˜ì–íŠ¸ ë¶€ì‚°"], a:1 },
  { q: "ì„œí¬ê°€ í˜„í˜¸ ë‹®ì•˜ë‹¤ê³  ì¥ë‚œì¹œ ë™ë¬¼ì€?", opts:["ë„ˆêµ¬ë¦¬","í–„ìŠ¤í„°","ì•ŒíŒŒì¹´"], a:1 },
  { q: "ë¹„ê°€ ì™€ë„ í•˜ìë©° ì–˜ê¸°í•œ 5/9 ë°ì´íŠ¸ëŠ”?", opts:["ë“œë¼ì´ë¸Œì¸ ì˜í™”(ììœ ë¡œ ìë™ì°¨ê·¹ì¥)","í•œê°• í”¼í¬ë‹‰","ë¯¸ìˆ ê´€ íˆ¬ì–´"], a:0 },
  { q: "ë‹¤ìŒì— ê°€ìê³  í•œ í…Œë§ˆíŒŒí¬ëŠ”?", opts:["ìºë¦¬ë¹„ì•ˆë² ì´","ë¡¯ë°ì›”ë“œ","ì—ë²„ëœë“œ"], a:2 },
  { q: "í˜„í˜¸ê°€ ì¦ê²¨ ë§ˆì‹œëŠ” ìŒë£ŒëŠ”?", opts:["ì œë¡œì½œë¼","ì•„ë©”ë¦¬ì¹´ë…¸","ë§¤ì‹¤ì°¨"], a:0 },
  { q: "í˜„í˜¸ê°€ ì¢‹ì•„í•œë‹¤ê³  í•œ ë² íŠ¸ë‚¨ ì±„ì†Œ ìš”ë¦¬ëŠ”?", opts:["ëª¨ë‹ê¸€ë¡œë¦¬(ê³µì‹¬ì±„)","ë¶„ì§œ","ì§œì¡°"], a:0 },
  { q: "í•©ì •ì—ì„œ ë“¤ë €ë˜ ì¹´í˜ëŠ”?", opts:["ë°¤ë¶€ ë² ì´ì»¤ë¦¬&ë¸Œë£¨ì‰","ì–´ë‹ˆì–¸","í…Œë¼ë¡œì‚¬"], a:0 },
];

const quizList = document.getElementById('quizList');
const quizProg = document.getElementById('quizProg');
const submitQuiz = document.getElementById('submitQuiz');
const quizResult = document.getElementById('quizResult');
const quizPassedBadge = document.getElementById('quizPassed');
let quizAnswers = {};

function renderQuiz(){
  quizList.innerHTML = '';
  quizData.forEach((it, i)=>{
    const wrap = document.createElement('div');
    wrap.className = 'q-item';
    const title = document.createElement('div');
    title.innerHTML = `<b>Q${i+1}.</b> ${it.q}`;
    wrap.appendChild(title);
    it.opts.forEach((op, k)=>{
      const row = document.createElement('label');
      row.className = 'opt';
      row.innerHTML = `
        <input type="radio" name="q${i}" value="${k}" ${quizAnswers[i]==k?'checked':''}/>
        <span>${op}</span>
      `;
      row.querySelector('input').addEventListener('change', ()=>{
        quizAnswers[i] = k;
        localStorage.setItem('quiz_answers', JSON.stringify(quizAnswers));
        updateQuizProgress();
      });
      wrap.appendChild(row);
    });
    quizList.appendChild(wrap);
  });
  updateQuizProgress();
}

function updateQuizProgress(){
  const answered = Object.keys(quizAnswers).length;
  quizProg.textContent = `${answered} / ${quizData.length} ì‘ë‹µ`;
}

function gradeQuiz(){
  let score = 0;
  quizData.forEach((it, i)=>{
    if(quizAnswers[i] === it.a) score++;
  });
  const passed = score >= 9;
  quizResult.textContent = `ì ìˆ˜: ${score} / ${quizData.length}  ${passed ? 'ğŸ‰ ì˜í–ˆì–´! í†µê³¼!' : 'ì¡°ê¸ˆë§Œ ë”! 9ê°œ ì´ìƒì´ë©´ í†µê³¼'}`;
  if(passed){
    quizPassedBadge.classList.add('on');
    localStorage.setItem('quiz_passed','1');
    try{ confetti(); }catch{}
    setTimeout(()=>go(1), 700);
  }else{
    quizPassedBadge.classList.remove('on');
    localStorage.removeItem('quiz_passed');
  }
}

submitQuiz.addEventListener('click', gradeQuiz);
if(localStorage.getItem('quiz_passed')==='1'){
  quizPassedBadge.classList.add('on');
}
renderQuiz();

/* ================= CH2: ìˆ¨ì€ í•˜íŠ¸ ================= */
const bg = document.getElementById('bg');
const bgUrl = document.getElementById('bgUrl');
const applyBg = document.getElementById('applyBg');
const findwrap = document.getElementById('findwrap');
const heartStatus = document.getElementById('heartStatus');
const HiddenHearts = { count:5, positions: [ {x:12,y:22},{x:40,y:18},{x:73,y:35},{x:25,y:68},{x:82,y:72} ] };
let found=0, total=HiddenHearts.count;
heartStatus.textContent = `0 / ${total}`;
bg.src = localStorage.getItem('photo') || "assets/photo2.jpg";
bgUrl.value = bg.src;

function placeHearts(){
  [...findwrap.querySelectorAll('.heart')].forEach(n=>n.remove());
  found=0; heartStatus.textContent = `0 / ${total}`;
  HiddenHearts.positions.slice(0,total).forEach((p)=>{
    const h=document.createElement('div'); h.className="heart"; h.textContent="â¤";
    h.style.left = `calc(${p.x}% - 15px)`; h.style.top = `calc(${p.y}% - 15px)`;
    h.onclick=()=>{
      if(h.dataset.hit) return;
      h.dataset.hit=1; h.style.opacity=.35; found++; heartStatus.textContent=`${found} / ${total}`;
      if(found>=total) setTimeout(()=>go(2), 400);
    };
    findwrap.appendChild(h);
  })
}
placeHearts();

applyBg.onclick = ()=>{
  const u = bgUrl.value.trim() || "assets/photo2.jpg";
  bg.src = u; document.getElementById('pv').src = u;
  localStorage.setItem('photo', u);
  initPuzzle(u);
};

/* ================= CH3: ë¯¸ë¡œ ================= */
const mazeEl = document.getElementById('maze');
let cellSize, rows, cols, player, goal;
function buildMaze(){
  mazeEl.innerHTML="";
  const MAPS = [
    ["000000","011110","000010","011010","010010","000000"], // ì‰¬ì›€
    ["0010000","0010110","0000100","0111100","0000000","0111110","0000000"],// ë³´í†µ
    ["001111000","000001000","011101110","010000010","010111010","010100010","010101010","010001010","011111010"], // ì–´ë ¤ì›€
    ["0000000000","0111111110","0000000010","0111111010","0100000010","0101111010","0101000010","0101011010","0100010010","0111111110"] // ë§¤ìš° ì–´ë ¤ì›€
  ];
  const map = MAPS[3].map(r=>r.split("").map(n=>+n));
  rows=map.length; cols=map[0].length;
  const W=mazeEl.clientWidth, H=mazeEl.clientHeight;
  cellSize=Math.floor(Math.min(W/cols, H/rows));
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      const div=document.createElement('div'); div.className='cell';
      div.style.width=cellSize+'px'; div.style.height=cellSize+'px';
      div.style.left=(c*cellSize)+'px'; div.style.top=(r*cellSize)+'px';
      if(map[r][c]===1) div.style.background="#ffd6e7";
      mazeEl.appendChild(div);
    }
  }
  player={r:0,c:0}; goal={r:rows-1,c:cols-1};
  const p=document.createElement('div'); p.className='player'; p.style.width=p.style.height=(cellSize-6)+'px';
  const g=document.createElement('div'); g.className='goal'; g.style.width=g.style.height=(cellSize-6)+'px';
  mazeEl.appendChild(g); mazeEl.appendChild(p);
  const place=(el, rc)=>{ el.style.left=(rc.c*cellSize+3)+'px'; el.style.top=(rc.r*cellSize+3)+'px'; };
  place(p,player); place(g,goal);
  const can=(r,c)=> r>=0 && r<rows && c>=0 && c<cols && map[r][c]===0;
  let sx,sy, moving=false;
  const moveBy=(dr,dc)=>{
    const nr=player.r+dr, nc=player.c+dc;
    if(can(nr,nc)){
      player.r=nr; player.c=nc; place(p,player);
      if(player.r===goal.r && player.c===goal.c){
        try{ confetti(); }catch{};
        setTimeout(()=>go(3), 500);
      }
    }
  };
  mazeEl.addEventListener('touchstart',e=>{ const t=e.touches[0]; sx=t.clientX; sy=t.clientY; moving=true; });
  mazeEl.addEventListener('touchend',()=>{ moving=false; });
  mazeEl.addEventListener('touchmove',e=>{
    if(!moving) return;
    const t=e.touches[0]; const dx=t.clientX-sx, dy=t.clientY-sy;
    if(Math.abs(dx)>28 || Math.abs(dy)>28){
      if(Math.abs(dx)>Math.abs(dy)) moveBy(0, dx>0?+1:-1); else moveBy(dy>0?+1:-1, 0);
      sx=t.clientX; sy=t.clientY;
    }
  });
  window.addEventListener('keydown',e=>{
    if(!mazeEl.closest('.active')) return;
    if(e.key==="ArrowUp") moveBy(-1,0);
    if(e.key==="ArrowDown") moveBy(1,0);
    if(e.key==="ArrowLeft") moveBy(0,-1);
    if(e.key==="ArrowRight") moveBy(0,1);
  });
}
new ResizeObserver(buildMaze).observe(mazeEl);

/* ================= CH4: í¼ì¦ ================= */
const board = document.getElementById('board');
const pv = document.getElementById('pv');
const pstat = document.getElementById('pstat');
const btnShuffle = document.getElementById('shuffle');
const btnSnap = document.getElementById('snap');
let SIZE,N=3,CELL,pieces=[];

function computeSize(){
  const rect=board.getBoundingClientRect();
  SIZE=Math.min(360, Math.floor(rect.width))||Math.min(360,Math.floor(innerWidth*0.94));
  CELL=Math.floor(SIZE/N);
  board.style.width=SIZE+'px'; board.style.height=SIZE+'px';
}

function setPieceSize(el){ el.style.width=CELL+'px'; el.style.height=CELL+'px'; }

function enableDrag(el){
  let sx,sy,ox,oy;
  const mv=e=>{
    const p=e.touches?e.touches[0]:e;
    const nx=Math.min(SIZE-CELL, Math.max(0, ox + (p.clientX - sx)));
    const ny=Math.min(SIZE-CELL, Math.max(0, oy + (p.clientY - sy)));
    el.style.left=nx+'px'; el.style.top=ny+'px';
  };
  const up=()=>{
    document.removeEventListener('mousemove',mv);document.removeEventListener('mouseup',up);
    document.removeEventListener('touchmove',mv);document.removeEventListener('touchend',up);
    snapMaybe(el); updatePct();
  };
  const dn=e=>{
    const p=e.touches?e.touches[0]:e; sx=p.clientX; sy=p.clientY;
    ox=parseFloat(el.style.left)||0; oy=parseFloat(el.style.top)||0;
    document.addEventListener('mousemove',mv);document.addEventListener('mouseup',up);
    document.addEventListener('touchmove',mv);document.addEventListener('touchend',up);
  };
  el.addEventListener('mousedown',dn); el.addEventListener('touchstart',dn);
}

function snapMaybe(el){
  const tx=+el.dataset.tx, ty=+el.dataset.ty;
  const ex=parseFloat(el.style.left)||0, ey=parseFloat(el.style.top)||0;
  const dist=Math.hypot(ex-tx, ey-ty);
  if(dist<Math.max(14, CELL*0.15)){
    el.style.left=tx+'px'; el.style.top=ty+'px';
  }
}

function updatePct(){
  let good=0;
  pieces.forEach(p=>{
    const tx=+p.dataset.tx, ty=+p.dataset.ty;
    const ex=Math.round(parseFloat(p.style.left)||0), ey=Math.round(parseFloat(p.style.top)||0);
    if(Math.abs(ex-tx)<2 && Math.abs(ey-ty)<2) good++;
  });
  const pct=Math.round((good/pieces.length)*100);
  pstat.textContent=pct+"% ì™„ë£Œ";
  if(pct>=90){
  try{ confetti(); }catch{};
  setTimeout(()=>{ 
    go(4); 
    // í¸ì§€ í˜ì´ì§€ë¡œ ì´ë™ í›„ BGM ìë™ì¬ìƒ ì‹œë„
    setTimeout(() => {
      tryPlayBGM();
    }, 100);
  }, 500);
}
}

function initPuzzle(img){
  computeSize(); board.innerHTML=""; pieces=[];
  for(let r=0;r<N;r++){
    for(let c=0;c<N;c++){
      const x=c*CELL, y=r*CELL;
      const el=document.createElement('div'); el.className='piece';
      setPieceSize(el);
      el.style.left=Math.random()*(SIZE-CELL)+'px';
      el.style.top=Math.random()*(SIZE-CELL)+'px';
      el.style.backgroundImage=`url(${img})`;
      el.style.backgroundSize=`${SIZE}px ${SIZE}px`;
      el.style.backgroundPosition=`-${x}px -${y}px`;
      el.dataset.tx=x; el.dataset.ty=y; enableDrag(el); board.appendChild(el); pieces.push(el);
    }
  }
  updatePct();
}

btnShuffle.onclick = ()=>{
  pieces.forEach(el=>{
    setPieceSize(el);
    el.style.left=Math.random()*(SIZE-CELL)+'px';
    el.style.top=Math.random()*(SIZE-CELL)+'px';
  });
  updatePct();
};

btnSnap.onclick = ()=>{
  pieces.forEach(el=>{
    el.style.left=el.dataset.tx+'px';
    el.style.top=el.dataset.ty+'px';
  });
  updatePct();
};

window.addEventListener('resize', ()=>initPuzzle(pv.src));
pv.src = localStorage.getItem('photo') || "assets/photo.jpg";
initPuzzle(pv.src);

/* ================= ì—”ë”© & ì €ì¥ ================= */
document.getElementById('applyBgm').onclick = ()=>{
  const u = document.getElementById('bgmUrl').value.trim() || "assets/bgm.mp3";
  document.getElementById('bgm').src = u;
};

document.getElementById('saveAll').onclick = ()=>{
  localStorage.setItem('letter', document.getElementById('letter').innerText);
  localStorage.setItem('bgm', document.getElementById('bgm').src);
  localStorage.setItem('photo', pv.src);
  alert('ì €ì¥ ì™„ë£Œ!');
};

// ì„ ë¬¼ í˜ì´ì§€ë¡œ ì´ë™
document.getElementById('nextGift').onclick = ()=>{
  go(5);
};

// BGM ìë™ì¬ìƒ (ì‚¬ìš©ì ìƒí˜¸ì‘ìš© í›„)
let bgmPlayed = false;
function tryPlayBGM() {
  if (!bgmPlayed) {
    const bgm = document.getElementById('bgm');
    bgm.play().then(() => {
      bgmPlayed = true;
      console.log('BGM ìë™ì¬ìƒ ì„±ê³µ!');
    }).catch((error) => {
      console.log('BGM ìë™ì¬ìƒ ì‹¤íŒ¨:', error.message);
      // ìë™ì¬ìƒì´ ì°¨ë‹¨ëœ ê²½ìš° ë¬´ì‹œ
    });
  }
}

// í´ë¦­, í„°ì¹˜, í‚¤ë³´ë“œ ë“± ëª¨ë“  ìƒí˜¸ì‘ìš©ì—ì„œ BGM ì¬ìƒ ì‹œë„
document.addEventListener('click', tryPlayBGM, { once: true });
document.addEventListener('touchstart', tryPlayBGM, { once: true });
document.addEventListener('keydown', tryPlayBGM, { once: true });

// ë³µì›
(function(){
  const L=localStorage.getItem('letter');
  if(L) document.getElementById('letter').innerText=L;
  const B=localStorage.getItem('bgm');
  if(B) document.getElementById('bgm').src=B;
  const P=localStorage.getItem('photo');
if(P){ document.getElementById('bg').src=P; pv.src=P; } else {
  document.getElementById('bg').src="assets/photo2.jpg";
  pv.src="assets/photo.jpg";
}
})();

/* ================= Confetti ================= */
const conf = document.getElementById('confetti');
const ctx = conf.getContext('2d');
let W, H;
function resize(){ W=conf.width=innerWidth; H=conf.height=innerHeight }
window.addEventListener('resize', resize);
resize();
let particles=[];
let playing=false;
let t0=0;

function confetti(){
  if(playing) return;
  playing=true;
  particles=[];
  t0=performance.now();
  for(let i=0;i<140;i++){
    particles.push({
      x: Math.random()*W,
      y: -20 - Math.random()*H*0.5,
      r: 3+Math.random()*4,
      vx: -1+Math.random()*2,
      vy: 2+Math.random()*3,
      rot: Math.random()*Math.PI,
      vr: -0.1+Math.random()*0.2,
      life: 0
    });
  }
  requestAnimationFrame(loop);
}

function loop(ts){
  const dt = Math.min(32, ts - t0);
  t0 = ts;
  ctx.clearRect(0,0,W,H);
  particles.forEach(p=>{
    p.x += p.vx;
    p.y += p.vy;
    p.rot += p.vr;
    p.vy += 0.02;
    p.life += dt;
    ctx.save();
    ctx.translate(p.x, p.y);
    ctx.rotate(p.rot);
    const hue = (p.life*0.12 + p.x*0.04)%360;
    ctx.fillStyle = `hsl(${hue} 90% 70%)`;
    const s = p.r*2;
    ctx.fillRect(-p.r, -p.r, s, s);
    ctx.restore();
  });
  particles = particles.filter(p=> p.y < H+20);
  if(particles.length>0){
    requestAnimationFrame(loop)
  } else {
    playing=false
  }
}
</script>
</body>
</html>
